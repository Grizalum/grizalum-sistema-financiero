<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GRIZALUM - Sistema Financiero Empresarial Premium</title>
    
    <!-- Meta Tags SEO -->
    <meta name="description" content="Sistema financiero empresarial premium con IA integrada para empresas peruanas. Dashboard ejecutivo, flujo de caja, an치lisis predictivo.">
    <meta name="keywords" content="sistema financiero, empresas peru, contabilidad, flujo de caja, dashboard, IA">
    <meta name="author" content="GRIZALUM">
    
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="src/assets/images/favicon.ico">
    
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    
    <!-- FontAwesome -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/js/all.min.js"></script>
    
    <!-- Chart.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.0/chart.min.js"></script>
    
    <!-- PWA MANIFEST -->
    <link rel="manifest" href="manifest.json">
    
    <!-- META TAGS PARA PWA -->
    <meta name="application-name" content="GRIZALUM">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="GRIZALUM">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="msapplication-TileColor" content="#d4af37">
    <meta name="theme-color" content="#d4af37">
    <meta name="msapplication-tap-highlight" content="no">
    
    <!-- ICONOS ADICIONALES -->
    <link rel="icon" type="image/png" sizes="32x32" href="src/assets/images/icon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="src/assets/images/icon-16x16.png">
    <link rel="apple-touch-icon" href="src/assets/images/icon-192x192.png">
    <link rel="apple-touch-icon" sizes="152x152" href="src/assets/images/icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="src/assets/images/icon-180x180.png">
    
    <!-- Microsoft tiles -->
    <meta name="msapplication-TileImage" content="src/assets/images/icon-144x144.png">
    <meta name="msapplication-config" content="browserconfig.xml">
    
    <!-- ESTILOS - ORDEN ESPEC칈FICO -->
    <link rel="stylesheet" href="src/assets/css/variables.css">
    <link rel="stylesheet" href="src/assets/css/base.css">
    <link rel="stylesheet" href="src/assets/css/components.css">
    <link rel="stylesheet" href="src/assets/css/layout.css">
    <link rel="stylesheet" href="src/assets/css/ai-panel.css">
    <link rel="stylesheet" href="src/assets/css/modals.css">
    <link rel="stylesheet" href="src/assets/css/responsive.css">
</head>
<body>
    <!-- Loading Screen -->
    <div id="loadingScreen" class="loading-screen">
        <div class="loading-content">
            <div class="brand-icon loading-logo">
                <i class="fas fa-chart-line"></i>
            </div>
            <h1>GRIZALUM</h1>
            <p>Cargando sistema financiero...</p>
            <div class="loading-bar">
                <div class="loading-progress"></div>
            </div>
        </div>
    </div>

    <div class="app-container">
        <!-- SIDEBAR -->
        <nav class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <div class="company-brand">
                    <div class="brand-icon">
                        <i class="fas fa-chart-line"></i>
                    </div>
                    <div class="brand-text">
                        <h1>GRIZALUM</h1>
                        <p>Control Financiero</p>
                    </div>
                </div>
                
                <div class="financial-summary">
                    <div class="summary-item">
                        <span class="summary-label">Flujo de Caja</span>
                        <span class="summary-value" id="sidebarCashFlow">S/. 24,500</span>
                    </div>
                    <div class="summary-item">
                        <span class="summary-label">Ingresos Mes</span>
                        <span class="summary-value" id="sidebarRevenue">S/. 45,200</span>
                    </div>
                    <div class="summary-item">
                        <span class="summary-label">Gastos Mes</span>
                        <span class="summary-value" id="sidebarExpenses">S/. 28,700</span>
                    </div>
                    <div class="summary-item">
                        <span class="summary-label">Utilidad Neta</span>
                        <span class="summary-value" id="sidebarProfit">S/. 16,500</span>
                    </div>
                </div>
            </div>

            <!-- MEN칔 DE NAVEGACI칍N -->
            <div class="nav-menu">
                <div class="nav-section">
                    <div class="nav-section-title">
                        <i class="fas fa-chart-bar"></i>
                        Panel Principal
                    </div>
                    <div class="nav-item">
                        <a href="#" class="nav-link active" onclick="showSection('dashboard')">
                            <i class="nav-icon fas fa-tachometer-alt"></i>
                            <span>Dashboard</span>
                        </a>
                    </div>
                    <div class="nav-item">
                        <a href="#" class="nav-link" onclick="showSection('cash-flow')">
                            <i class="nav-icon fas fa-water"></i>
                            <span>Flujo de Caja</span>
                        </a>
                    </div>
                </div>

                <div class="nav-section">
                    <div class="nav-section-title">
                        <i class="fas fa-calculator"></i>
                        Contabilidad
                    </div>
                    <div class="nav-item">
                        <a href="#" class="nav-link" onclick="showSection('income-statement')">
                            <i class="nav-icon fas fa-chart-pie"></i>
                            <span>Estado de Resultados</span>
                        </a>
                    </div>
                    <div class="nav-item">
                        <a href="#" class="nav-link" onclick="showSection('balance-sheet')">
                            <i class="nav-icon fas fa-balance-scale"></i>
                            <span>Balance General</span>
                        </a>
                    </div>
                    <div class="nav-item">
                        <a href="#" class="nav-link" onclick="showSection('accounts-receivable')">
                            <i class="nav-icon fas fa-coins"></i>
                            <span>Cuentas por Cobrar</span>
                        </a>
                    </div>
                    <div class="nav-item">
                        <a href="#" class="nav-link" onclick="showSection('accounts-payable')">
                            <i class="nav-icon fas fa-credit-card"></i>
                            <span>Cuentas por Pagar</span>
                        </a>
                    </div>
                </div>

                <div class="nav-section">
                    <div class="nav-section-title">
                        <i class="fas fa-warehouse"></i>
                        Operaciones
                    </div>
                    <div class="nav-item">
                        <a href="#" class="nav-link" onclick="showSection('inventory')">
                            <i class="nav-icon fas fa-boxes"></i>
                            <span>Inventario</span>
                        </a>
                    </div>
                    <div class="nav-item">
                        <a href="#" class="nav-link" onclick="showSection('sales')">
                            <i class="nav-icon fas fa-shopping-cart"></i>
                            <span>Ventas</span>
                        </a>
                    </div>
                    <div class="nav-item">
                        <a href="#" class="nav-link" onclick="showSection('purchases')">
                            <i class="nav-icon fas fa-truck"></i>
                            <span>Compras</span>
                        </a>
                    </div>
                </div>

                <div class="nav-section">
                    <div class="nav-section-title">
                        <i class="fas fa-chart-area"></i>
                        An치lisis
                    </div>
                    <div class="nav-item">
                        <a href="#" class="nav-link" onclick="showSection('financial-analysis')">
                            <i class="nav-icon fas fa-magnifying-glass-chart"></i>
                            <span>An치lisis Financiero</span>
                        </a>
                    </div>
                    <div class="nav-item">
                        <a href="#" class="nav-link" onclick="showSection('reports')">
                            <i class="nav-icon fas fa-file-alt"></i>
                            <span>Reportes</span>
                        </a>
                    </div>
                </div>
            </div>
        </nav>

        <!-- MAIN CONTENT -->
        <main class="main-content">
            <!-- HEADER -->
            <header class="executive-header">
                <button class="mobile-menu-toggle" onclick="toggleSidebar()">
                    <i class="fas fa-bars"></i>
                </button>
                
                <div class="page-header">
                    <div>
                        <h1 class="page-title" id="pageTitle">Dashboard Ejecutivo</h1>
                        <p class="page-subtitle" id="pageSubtitle">Resumen financiero en tiempo real</p>
                        <div class="ai-insights">
                            <i class="fas fa-brain"></i>
                            <span>IA predice crecimiento del 15% este trimestre</span>
                        </div>
                    </div>
                </div>

                <div class="header-controls">
                    <div class="time-period-selector">
                        <button class="period-btn active" onclick="changePeriod('hoy', this)">Hoy</button>
                        <button class="period-btn" onclick="changePeriod('semana', this)">Semana</button>
                        <button class="period-btn" onclick="changePeriod('mes', this)">Mes</button>
                        <button class="period-btn" onclick="changePeriod('trimestre', this)">Trimestre</button>
                        <button class="period-btn" onclick="changePeriod('a침o', this)">A침o</button>
                    </div>

                    <button class="notification-center" onclick="showNotifications()">
                        <i class="fas fa-bell"></i>
                        <span class="notification-badge">3</span>
                    </button>

                    <!-- SELECTOR DE EMPRESAS -->
                    <div class="company-selector" id="companySelector">
                        <div class="selected-company" onclick="toggleCompanyDropdown()">
                            <div class="company-info">
                                <div class="company-icon" id="currentCompanyIcon">游댠</div>
                                <div class="company-details">
                                    <div class="company-name" id="currentCompanyName">Fundici칩n Laguna</div>
                                    <div class="company-status" id="currentCompanyStatus">游릭 Operativo</div>
                                </div>
                            </div>
                            <div class="dropdown-arrow">
                                <i class="fas fa-chevron-down" id="dropdownArrow"></i>
                            </div>
                        </div>
                        
                        <div class="company-dropdown" id="companyDropdown">
                            <div class="dropdown-header">
                                <h4>游끽 Empresas GRIZALUM</h4>
                                <button class="btn-add-company" onclick="showAddCompanyWizard()">
                                    <i class="fas fa-plus"></i>
                                    Agregar Nueva
                                </button>
                            </div>
                            
                            <div class="companies-list">
                                <div class="company-item active" data-company="fundicion-laguna" onclick="selectCompany('fundicion-laguna')">
                                    <div class="company-item-icon">游댠</div>
                                    <div class="company-item-info">
                                        <div class="company-item-name">Fundici칩n Laguna</div>
                                        <div class="company-item-stats">Flujo: S/. 24,500</div>
                                    </div>
                                    <div class="company-item-status">游릭</div>
                                </div>
                                
                                <div class="company-item" data-company="fundicion-joel" onclick="selectCompany('fundicion-joel')">
                                    <div class="company-item-icon">游댠</div>
                                    <div class="company-item-info">
                                        <div class="company-item-name">Fundici칩n Joel</div>
                                        <div class="company-item-stats">Flujo: S/. 18,300</div>
                                    </div>
                                    <div class="company-item-status">游릭</div>
                                </div>
                                
                                <div class="company-item" data-company="avicola-san-juan" onclick="selectCompany('avicola-san-juan')">
                                    <div class="company-item-icon">游냆</div>
                                    <div class="company-item-info">
                                        <div class="company-item-name">Av칤cola San Juan</div>
                                        <div class="company-item-stats">Flujo: S/. 32,100</div>
                                    </div>
                                    <div class="company-item-status">游릭</div>
                                </div>
                                
                                <div class="company-item" data-company="bodega-central" onclick="selectCompany('bodega-central')">
                                    <div class="company-item-icon">游낅</div>
                                    <div class="company-item-info">
                                        <div class="company-item-name">Bodega Central</div>
                                        <div class="company-item-stats">Flujo: S/. 15,800</div>
                                    </div>
                                    <div class="company-item-status">游리</div>
                                </div>
                                
                                <div class="company-item" data-company="importaciones-gz" onclick="selectCompany('importaciones-gz')">
                                    <div class="company-item-icon">游닍</div>
                                    <div class="company-item-info">
                                        <div class="company-item-name">Importaciones GZ</div>
                                        <div class="company-item-stats">Flujo: S/. 45,200</div>
                                    </div>
                                    <div class="company-item-status">游릭</div>
                                </div>
                            </div>
                            
                            <div class="dropdown-footer">
                                <div class="total-companies">
                                    <strong>游늵 Total Holding: S/. 135,900</strong>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </header>

            <!-- CONTENT AREA -->
            <div class="content-area">
                <!-- DASHBOARD SECTION -->
                <section class="page-section active" id="dashboard">
                    <!-- REAL-TIME INDICATOR -->
                    <div style="margin-bottom: 1rem;">
                        <div class="real-time-indicator">
                            <div class="real-time-dot"></div>
                            <span>Datos actualizados hace 2 minutos</span>
                        </div>
                    </div>

                    <!-- KPI CARDS -->
                    <div class="kpi-grid">
                        <div class="kpi-card cash-flow profit-glow micro-interaction">
                            <div class="kpi-header">
                                <div class="kpi-info">
                                    <h3>Flujo de Caja Actual</h3>
                                    <p class="kpi-period">Julio 2025</p>
                                </div>
                                <div class="kpi-icon" style="background: var(--gradient-profit)">
                                    <i class="fas fa-water"></i>
                                </div>
                            </div>
                            <div class="kpi-value kpi-value-animation">S/. 24,500</div>
                            <div class="kpi-change">
                                <div class="change-indicator change-positive">
                                    <i class="fas fa-arrow-up"></i>
                                    <span>+18.5%</span>
                                </div>
                                <span>vs mes anterior</span>
                            </div>
                            <div class="ai-prediction">
                                <i class="fas fa-brain ai-prediction-icon"></i>
                                <strong>IA predice:</strong> Flujo positivo sostenido pr칩ximos 3 meses
                            </div>
                        </div>

                        <div class="kpi-card revenue micro-interaction">
                            <div class="kpi-header">
                                <div class="kpi-info">
                                    <h3>Ingresos Totales</h3>
                                    <p class="kpi-period">Julio 2025</p>
                                </div>
                                <div class="kpi-icon" style="background: var(--gradient-blue)">
                                    <i class="fas fa-chart-line"></i>
                                </div>
                            </div>
                            <div class="kpi-value kpi-value-animation">S/. 45,200</div>
                            <div class="kpi-change">
                                <div class="change-indicator change-positive">
                                    <i class="fas fa-arrow-up"></i>
                                    <span>+12.3%</span>
                                </div>
                                <span>vs mes anterior</span>
                            </div>
                            <div class="ai-prediction">
                                <i class="fas fa-brain ai-prediction-icon"></i>
                                <strong>IA sugiere:</strong> Meta agosto: S/. 52,000 (alcanzable)
                            </div>
                        </div>

                        <div class="kpi-card expenses micro-interaction">
                            <div class="kpi-header">
                                <div class="kpi-info">
                                    <h3>Gastos Operativos</h3>
                                    <p class="kpi-period">Julio 2025</p>
                                </div>
                                <div class="kpi-icon" style="background: var(--gradient-loss)">
                                    <i class="fas fa-chart-line-down"></i>
                                </div>
                            </div>
                            <div class="kpi-value kpi-value-animation">S/. 28,700</div>
                            <div class="kpi-change">
                                <div class="change-indicator change-positive">
                                    <i class="fas fa-arrow-down"></i>
                                    <span>-5.2%</span>
                                </div>
                                <span>vs mes anterior</span>
                            </div>
                            <div class="ai-prediction">
                                <i class="fas fa-brain ai-prediction-icon"></i>
                                <strong>IA alerta:</strong> Gasto en marketing puede optimizarse 15%
                            </div>
                        </div>

                        <div class="kpi-card profit gold-glow micro-interaction">
                            <div class="kpi-header">
                                <div class="kpi-info">
                                    <h3>Utilidad Neta</h3>
                                    <p class="kpi-period">Julio 2025</p>
                                </div>
                                <div class="kpi-icon" style="background: var(--gradient-gold)">
                                    <i class="fas fa-trophy"></i>
                                </div>
                            </div>
                            <div class="kpi-value kpi-value-animation">S/. 16,500</div>
                            <div class="kpi-change">
                                <div class="change-indicator change-positive">
                                    <i class="fas fa-arrow-up"></i>
                                    <span>+28.7%</span>
                                </div>
                                <span>Margen: 36.5%</span>
                            </div>
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: 73%" title="Meta anual: 73% completado"></div>
                            </div>
                        </div>
                    </div>

                    <!-- CHARTS SECTION -->
                    <div class="charts-section">
                        <div class="chart-card">
                            <div class="chart-header">
                                <h3 class="chart-title">
                                    <i class="chart-icon fas fa-chart-line"></i>
                                    Tendencia de Ingresos vs Gastos
                                </h3>
                                <div class="real-time-indicator">
                                    <div class="real-time-dot"></div>
                                    <span>Tiempo Real</span>
                                </div>
                            </div>
                            <div class="chart-container">
                                <canvas id="revenueChart"></canvas>
                            </div>
                        </div>

                        <div class="chart-card">
                            <div class="chart-header">
                                <h3 class="chart-title">
                                    <i class="chart-icon fas fa-chart-pie"></i>
                                    Distribuci칩n de Gastos
                                </h3>
                            </div>
                            <div class="chart-container">
                                <canvas id="expensesChart"></canvas>
                            </div>
                        </div>

                        <div class="chart-card">
                            <div class="chart-header">
                                <h3 class="chart-title">
                                    <i class="chart-icon fas fa-water"></i>
                                    Flujo de Caja Proyectado
                                </h3>
                            </div>
                            <div class="chart-container">
                                <canvas id="cashFlowChart"></canvas>
                            </div>
                        </div>

                        <div class="chart-card">
                            <div class="chart-header">
                                <h3 class="chart-title">
                                    <i class="chart-icon fas fa-coins"></i>
                                    Aging Cuentas por Cobrar
                                </h3>
                            </div>
                            <div class="chart-container">
                                <canvas id="agingChart"></canvas>
                            </div>
                        </div>
                    </div>

                    <!-- AI INSIGHTS SECTION -->
                    <div class="executive-card">
                        <div class="card-header">
                            <h2 class="card-title">
                                <i class="card-icon fas fa-brain"></i>
                                Insights de Inteligencia Artificial
                            </h2>
                            <div class="card-actions">
                                <button class="btn btn-primary btn-sm" onclick="generateAIReport()">
                                    <i class="fas fa-magic"></i>
                                    Generar An치lisis IA
                                </button>
                            </div>
                        </div>

                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1.5rem;">
                            <div style="background: linear-gradient(135deg, rgba(99, 102, 241, 0.1) 0%, rgba(139, 92, 246, 0.1) 100%); padding: 1.5rem; border-radius: 16px; border: 1px solid rgba(99, 102, 241, 0.2);">
                                <h4 style="color: var(--indigo); margin-bottom: 1rem; font-weight: 700;">
                                    <i class="fas fa-chart-line" style="margin-right: 0.5rem;"></i>
                                    Predicci칩n de Ventas
                                </h4>
                                <p style="color: var(--gray-700); line-height: 1.6;">
                                    Basado en datos hist칩ricos y tendencias actuales, las ventas de agosto podr칤an alcanzar <strong>S/. 52,000</strong> (+15% vs julio). 
                                    Recomendaci칩n: Incrementar inventario de productos estrella.
                                </p>
                            </div>

                            <div style="background: linear-gradient(135deg, rgba(5, 150, 105, 0.1) 0%, rgba(16, 185, 129, 0.1) 100%); padding: 1.5rem; border-radius: 16px; border: 1px solid rgba(5, 150, 105, 0.2);">
                                <h4 style="color: var(--profit); margin-bottom: 1rem; font-weight: 700;">
                                    <i class="fas fa-coins" style="margin-right: 0.5rem;"></i>
                                    Optimizaci칩n de Cobranzas
                                </h4>
                                <p style="color: var(--gray-700); line-height: 1.6;">
                                    <strong>3 clientes</strong> est치n cerca del l칤mite de cr칠dito. Contactar esta semana podr칤a recuperar 
                                    <strong>S/. 15,200</strong> y mejorar el flujo de caja en 8 d칤as.
                                </p>
                            </div>

                            <div style="background: linear-gradient(135deg, rgba(217, 119, 6, 0.1) 0%, rgba(245, 158, 11, 0.1) 100%); padding: 1.5rem; border-radius: 16px; border: 1px solid rgba(217, 119, 6, 0.2);">
                                <h4 style="color: var(--warning); margin-bottom: 1rem; font-weight: 700;">
                                    <i class="fas fa-exclamation-triangle" style="margin-right: 0.5rem;"></i>
                                    Alerta de Inventario
                                </h4>
                                <p style="color: var(--gray-700); line-height: 1.6;">
                                    El producto "Material Premium" se agotar치 en <strong>12 d칤as</strong> al ritmo actual. 
                                    Generar orden de compra por <strong>S/. 8,500</strong> para evitar quiebre de stock.
                                </p>
                            </div>

                            <div style="background: linear-gradient(135deg, rgba(212, 175, 55, 0.1) 0%, rgba(184, 115, 51, 0.1) 100%); padding: 1.5rem; border-radius: 16px; border: 1px solid rgba(212, 175, 55, 0.2);">
                                <h4 style="color: var(--peru-gold); margin-bottom: 1rem; font-weight: 700;">
                                    <i class="fas fa-chart-bar" style="margin-right: 0.5rem;"></i>
                                    Oportunidad de Ahorro
                                </h4>
                                <p style="color: var(--gray-700); line-height: 1.6;">
                                    Renegociar contrato con proveedor principal podr칤a ahorrar <strong>S/. 3,200/mes</strong> 
                                    (11% del gasto actual). ROI estimado: 340% anual.
                                </p>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- CASH FLOW SECTION -->
                <section class="page-section" id="cash-flow">
                    <div class="executive-card">
                        <div class="card-header">
                            <h2 class="card-title">
                                <i class="card-icon fas fa-water"></i>
                                Gesti칩n de Flujo de Caja
                            </h2>
                            <div class="card-actions">
                                <button class="btn btn-success" onclick="exportCashFlow()">
                                    <i class="fas fa-download"></i>
                                    Exportar
                                </button>
                                <button class="btn btn-primary" onclick="showCashFlowForm()">
                                    <i class="fas fa-plus"></i>
                                    Nueva Transacci칩n
                                </button>
                            </div>
                        </div>

                        <!-- CASH FLOW TABLE -->
                        <table class="financial-table">
                            <thead>
                                <tr>
                                    <th>Fecha</th>
                                    <th>Descripci칩n</th>
                                    <th>Categor칤a</th>
                                    <th>Tipo</th>
                                    <th>Entrada</th>
                                    <th>Sal
